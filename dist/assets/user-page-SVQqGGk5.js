import{j as e,k as s,m as a,n as l,o as n}from"./index-CvTZHx2e.js";import{r}from"./redux-vendor-nVRhWwEL.js";import{b as t}from"./banks-wbT4UHzr.js";import{M as c}from"./index-Cj0LOKaf.js";import{y as i}from"./ui-vendor-BXfdezGw.js";import"./react-vendor-B_uAldPx.js";function d({users:s,deleteUser:a,updateUserRole:l,updateUserBalance:n}){const[d,o]=r.useState(1),[u,h]=r.useState(10),[x,m]=r.useState(""),[j,p]=r.useState(null),[b,v]=r.useState(0),N=e=>e.toLocaleString("en-US"),g=r.useMemo(()=>{const e=x.toLowerCase();return s.filter(s=>{const a=s.username.toLowerCase().includes(e),l=s.userId.toString().includes(x);return a||l})},[x,s]),f=r.useMemo(()=>g.slice().sort((e,s)=>s.userId-e.userId),[g]),C=f.slice((d-1)*u,d*u),I=Math.ceil(f.length/u);return e.jsxs("div",{className:"admin-table-wrapper",children:[e.jsx("input",{type:"text",className:"admin-search-input",placeholder:"Хайлт (Нэр эсвэл ID)",value:x,onChange:e=>m(e.target.value)}),e.jsxs("table",{className:"admin-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"№"}),e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Нэр"}),e.jsx("th",{children:"Дансны дугаар"}),e.jsx("th",{children:"Банк"}),e.jsx("th",{children:"Үлдэгдэл"}),e.jsx("th",{children:"Эрх"}),e.jsx("th",{children:"Үйлдэл"})]})}),e.jsx("tbody",{children:C.map((s,n)=>{var r,o;return e.jsxs("tr",{className:"admin-userList",children:[e.jsx("td",{className:"table-index",children:(d-1)*u+n+1}),e.jsx("td",{className:"table-id",children:s.userId}),e.jsx("td",{className:"table-user",children:s.username}),e.jsx("td",{children:s.accountNumber}),e.jsx("td",{children:(null==(r=t.find(e=>e.value===s.bankName))?void 0:r.label)||s.bankName}),e.jsx("td",{className:"table-amount",children:e.jsxs("button",{className:"btn-edit",onClick:()=>(e=>{var s;p(e),v((null==(s=e.userBalance)?void 0:s.balance)??0)})(s),children:[N((null==(o=s.userBalance)?void 0:o.balance)??0),"₮"]})}),e.jsx("td",{className:"table-role",children:e.jsxs("select",{value:s.role,onChange:e=>l({userId:s.userId,role:e.target.value}).unwrap().then(()=>i.success("Эрх амжилттай шинэчлэгдлээ!")).catch(()=>i.error("Алдаа гарлаа!")),children:[e.jsx("option",{value:"USER",children:"User"}),e.jsx("option",{value:"ADMIN",children:"Admin"})]})}),e.jsx("td",{className:"table-action",children:e.jsx("button",{className:"btn-action btn-danger",onClick:()=>a(s.userId),children:e.jsx(c,{})})})]},s.userId)})})]}),e.jsxs("div",{className:"pagination-controls",children:[e.jsxs("span",{children:["Хуудас ",d," of ",I]}),e.jsx("button",{onClick:()=>o(Math.max(1,d-1)),disabled:1===d,children:"Өмнөх"}),e.jsx("button",{onClick:()=>o(Math.min(I,d+1)),disabled:d===I,children:"Дараагийнх"}),e.jsx("label",{children:e.jsx("select",{className:"custom-select",value:u,onChange:e=>h(Number(e.target.value)),children:[10,20,50,100].map(s=>e.jsx("option",{children:s},s))})}),e.jsxs("span",{children:["Нийт: ",s.length," "]})]}),j&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-box",children:[e.jsx("h2",{children:"Үлдэгдэл засах"}),e.jsx("p",{children:j.username}),e.jsx("input",{type:"text",className:"modal-input",value:N(b),onChange:e=>{const s=e.target.value.replace(/,/g,""),a=Number(s);isNaN(a)||v(a)}}),e.jsxs("div",{style:{marginTop:"6px",fontWeight:"bold"},children:[N(b)," ₮"]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{className:"btn-cancel",onClick:()=>p(null),children:"Болих"}),e.jsx("button",{className:"btn-save",onClick:()=>{j&&n({userId:j.userId,balance:b}).unwrap().then(()=>{i.success("Үлдэгдэл амжилттай шинэчлэгдлээ!"),p(null)}).catch(()=>i.error("Алдаа гарлаа!"))},children:"Хадгалах"})]})]})})]})}function o(){const{data:t}=s(),[c]=a(),[i]=l(),[o]=n(),[u,h]=r.useState("ALL"),x=(t||[]).filter(e=>{var s;return"ALL"===u||(null==(s=e.role)?void 0:s.toUpperCase())===u});return e.jsxs("div",{className:"user-page-wrapper",children:[e.jsxs("select",{id:"role-filter",className:"user-page-select",value:u,onChange:e=>h(e.target.value),children:[e.jsx("option",{value:"ALL",children:"Бүх хэрэглэгч"}),e.jsx("option",{value:"ADMIN",children:"Зөвхөн админ"}),e.jsx("option",{value:"USER",children:"Зөвхөн хэрэглэгч"})]}),e.jsx(d,{users:x,deleteUser:i,updateUserRole:c,updateUserBalance:o})]})}export{o as default};
